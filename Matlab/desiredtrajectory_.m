function [desired_state] = desiredtrajectory_(in)%(t, pos)
t  = in(1)
pos = in(2:10);
Sf = [ 1; 2; pi/4];
dSf = [0;0;0];

Pf = [ 0.1*t; 0; 0.5*sin(0.03*pi*t) + 2; 0; 0.01*pi*t ; 0];
dPf = [ 0.1; 0; 0.5*0.03*pi*cos(0.03*pi*t); 0; 0.01*pi; 0];

qd = [Pf; Sf];
qddot = [dPf; dSf];
pf = Sf(1); qf = Sf(2); betaf = Sf(3);
xf = Pf(1); yf = Pf(2); zf = Pf(3);
phif = Pf(4); thetaf = Pf(5); psif = Pf(6);
rf  = sqrt(pf^2+qf^2-2*pf*qf*cos(betaf));
                       
                  h1 =  sqrt(0.5*(pf^2+qf^2-0.5*rf^2));
                  h2 =  sqrt(0.5*(rf^2+pf^2-0.5*qf^2));
                  h3 =  sqrt(0.5*(qf^2+rf^2-0.5*pf^2));
                   
alf1  = acos((4*(h1^2+h2^2)-9*pf^2)/(8*h1*h2));
alf2  = acos((4*(h1^2+h3^2)-9*qf^2)/(8*h1*h3)); 
      
Rot = RPYtoRot_ZXY(phif, thetaf, psif);
pos_des = [Rot*[2/3;0;0]+[xf;yf;zf]
           Rot*[2/3*h2*cos(alf1);2/3*h2*sin(alf1);0]+[xf;yf;zf]
           Rot*[2/3*h2*cos(alf2);-2/3*h3*sin(alf2);0]+[xf;yf;zf]];

jac_val = [ 1, 0, 0,                                                                                                                                                                                                                                                                                                                                                                                                    -(2*cos(phif)*sin(psif)*sin(thetaf))/3,                                                                                                                                                                                                                                                                                                                                                                                                                           - (2*cos(psif)*sin(thetaf))/3 - (2*cos(thetaf)*sin(phif)*sin(psif))/3,                                                                                                                                                                                                                                                                                                                                                                                                                         - (2*cos(thetaf)*sin(psif))/3 - (2*cos(psif)*sin(phif)*sin(thetaf))/3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              0
 0, 1, 0,                                                                                                                                                                                                                                                                                                                                                                                                                 (2*sin(phif)*sin(psif))/3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                    -(2*cos(phif)*cos(psif))/3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        0
 0, 0, 1,                                                                                                                                                                                                                                                                                                                                                                                                     (2*cos(phif)*cos(thetaf)*sin(psif))/3,                                                                                                                                                                                                                                                                                                                                                                                                                             (2*cos(psif)*cos(thetaf))/3 - (2*sin(phif)*sin(psif)*sin(thetaf))/3,                                                                                                                                                                                                                                                                                                                                                                                                                           (2*cos(psif)*cos(thetaf)*sin(phif))/3 - (2*sin(psif)*sin(thetaf))/3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        0
 1, 0, 0,                                                                                       (2*cos(phif)*cos(psif)*sin(thetaf)*(1 - (4*pf^2 + 2*cos(betaf)*pf*qf - 2*qf^2)^2/(64*(pf^2 - cos(betaf)*pf*qf + qf^2/4)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)))^(1/2)*(pf^2 - cos(betaf)*pf*qf + qf^2/4)^(1/2))/3 + (cos(phif)*sin(psif)*sin(thetaf)*(4*pf^2 + 2*cos(betaf)*pf*qf - 2*qf^2))/(12*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)^(1/2)),                                                                                         ((cos(psif)*sin(thetaf) + cos(thetaf)*sin(phif)*sin(psif))*(4*pf^2 + 2*cos(betaf)*pf*qf - 2*qf^2))/(12*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)^(1/2)) - (2*(sin(psif)*sin(thetaf) - cos(psif)*cos(thetaf)*sin(phif))*(1 - (4*pf^2 + 2*cos(betaf)*pf*qf - 2*qf^2)^2/(64*(pf^2 - cos(betaf)*pf*qf + qf^2/4)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)))^(1/2)*(pf^2 - cos(betaf)*pf*qf + qf^2/4)^(1/2))/3,                                                                                       ((cos(thetaf)*sin(psif) + cos(psif)*sin(phif)*sin(thetaf))*(4*pf^2 + 2*cos(betaf)*pf*qf - 2*qf^2))/(12*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)^(1/2)) + (2*(cos(psif)*cos(thetaf) - sin(phif)*sin(psif)*sin(thetaf))*(1 - (4*pf^2 + 2*cos(betaf)*pf*qf - 2*qf^2)^2/(64*(pf^2 - cos(betaf)*pf*qf + qf^2/4)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)))^(1/2)*(pf^2 - cos(betaf)*pf*qf + qf^2/4)^(1/2))/3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         ((cos(thetaf)*sin(psif) + cos(psif)*sin(phif)*sin(thetaf))*(pf^2 - cos(betaf)*pf*qf + qf^2/4)^(1/2)*(((2*pf - qf*cos(betaf))*(4*pf^2 + 2*cos(betaf)*pf*qf - 2*qf^2)^2)/(64*(pf^2 - cos(betaf)*pf*qf + qf^2/4)^2*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)) + ((pf/2 + (qf*cos(betaf))/2)*(4*pf^2 + 2*cos(betaf)*pf*qf - 2*qf^2)^2)/(64*(pf^2 - cos(betaf)*pf*qf + qf^2/4)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)^2) - ((8*pf + 2*qf*cos(betaf))*(4*pf^2 + 2*cos(betaf)*pf*qf - 2*qf^2))/(32*(pf^2 - cos(betaf)*pf*qf + qf^2/4)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4))))/(3*(1 - (4*pf^2 + 2*cos(betaf)*pf*qf - 2*qf^2)^2/(64*(pf^2 - cos(betaf)*pf*qf + qf^2/4)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)))^(1/2)) - ((cos(psif)*cos(thetaf) - sin(phif)*sin(psif)*sin(thetaf))*(8*pf + 2*qf*cos(betaf)))/(12*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)^(1/2)) + ((cos(psif)*cos(thetaf) - sin(phif)*sin(psif)*sin(thetaf))*(pf/2 + (qf*cos(betaf))/2)*(4*pf^2 + 2*cos(betaf)*pf*qf - 2*qf^2))/(24*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)^(3/2)) + ((cos(thetaf)*sin(psif) + cos(psif)*sin(phif)*sin(thetaf))*(2*pf - qf*cos(betaf))*(1 - (4*pf^2 + 2*cos(betaf)*pf*qf - 2*qf^2)^2/(64*(pf^2 - cos(betaf)*pf*qf + qf^2/4)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)))^(1/2))/(3*(pf^2 - cos(betaf)*pf*qf + qf^2/4)^(1/2)),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         ((cos(psif)*cos(thetaf) - sin(phif)*sin(psif)*sin(thetaf))*(4*qf - 2*pf*cos(betaf)))/(12*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)^(1/2)) + ((cos(thetaf)*sin(psif) + cos(psif)*sin(phif)*sin(thetaf))*(pf^2 - cos(betaf)*pf*qf + qf^2/4)^(1/2)*(((qf/2 - pf*cos(betaf))*(4*pf^2 + 2*cos(betaf)*pf*qf - 2*qf^2)^2)/(64*(pf^2 - cos(betaf)*pf*qf + qf^2/4)^2*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)) + ((qf/2 + (pf*cos(betaf))/2)*(4*pf^2 + 2*cos(betaf)*pf*qf - 2*qf^2)^2)/(64*(pf^2 - cos(betaf)*pf*qf + qf^2/4)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)^2) + ((4*qf - 2*pf*cos(betaf))*(4*pf^2 + 2*cos(betaf)*pf*qf - 2*qf^2))/(32*(pf^2 - cos(betaf)*pf*qf + qf^2/4)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4))))/(3*(1 - (4*pf^2 + 2*cos(betaf)*pf*qf - 2*qf^2)^2/(64*(pf^2 - cos(betaf)*pf*qf + qf^2/4)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)))^(1/2)) + ((cos(psif)*cos(thetaf) - sin(phif)*sin(psif)*sin(thetaf))*(qf/2 + (pf*cos(betaf))/2)*(4*pf^2 + 2*cos(betaf)*pf*qf - 2*qf^2))/(24*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)^(3/2)) + ((cos(thetaf)*sin(psif) + cos(psif)*sin(phif)*sin(thetaf))*(qf/2 - pf*cos(betaf))*(1 - (4*pf^2 + 2*cos(betaf)*pf*qf - 2*qf^2)^2/(64*(pf^2 - cos(betaf)*pf*qf + qf^2/4)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)))^(1/2))/(3*(pf^2 - cos(betaf)*pf*qf + qf^2/4)^(1/2)),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             ((cos(thetaf)*sin(psif) + cos(psif)*sin(phif)*sin(thetaf))*(pf^2 - cos(betaf)*pf*qf + qf^2/4)^(1/2)*((pf*qf*sin(betaf)*(4*pf^2 + 2*cos(betaf)*pf*qf - 2*qf^2)^2)/(64*(pf^2 - cos(betaf)*pf*qf + qf^2/4)^2*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)) - (pf*qf*sin(betaf)*(4*pf^2 + 2*cos(betaf)*pf*qf - 2*qf^2)^2)/(128*(pf^2 - cos(betaf)*pf*qf + qf^2/4)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)^2) + (pf*qf*sin(betaf)*(4*pf^2 + 2*cos(betaf)*pf*qf - 2*qf^2))/(16*(pf^2 - cos(betaf)*pf*qf + qf^2/4)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4))))/(3*(1 - (4*pf^2 + 2*cos(betaf)*pf*qf - 2*qf^2)^2/(64*(pf^2 - cos(betaf)*pf*qf + qf^2/4)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)))^(1/2)) + (pf*qf*sin(betaf)*(cos(psif)*cos(thetaf) - sin(phif)*sin(psif)*sin(thetaf)))/(6*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)^(1/2)) - (pf*qf*sin(betaf)*(cos(psif)*cos(thetaf) - sin(phif)*sin(psif)*sin(thetaf))*(4*pf^2 + 2*cos(betaf)*pf*qf - 2*qf^2))/(48*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)^(3/2)) + (pf*qf*sin(betaf)*(cos(thetaf)*sin(psif) + cos(psif)*sin(phif)*sin(thetaf))*(1 - (4*pf^2 + 2*cos(betaf)*pf*qf - 2*qf^2)^2/(64*(pf^2 - cos(betaf)*pf*qf + qf^2/4)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)))^(1/2))/(3*(pf^2 - cos(betaf)*pf*qf + qf^2/4)^(1/2))
 0, 1, 0,                                                                                                             - (2*cos(psif)*sin(phif)*(1 - (4*pf^2 + 2*cos(betaf)*pf*qf - 2*qf^2)^2/(64*(pf^2 - cos(betaf)*pf*qf + qf^2/4)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)))^(1/2)*(pf^2 - cos(betaf)*pf*qf + qf^2/4)^(1/2))/3 - (sin(phif)*sin(psif)*(4*pf^2 + 2*cos(betaf)*pf*qf - 2*qf^2))/(12*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)^(1/2)),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               0,                                                                                                                                                                   (cos(phif)*cos(psif)*(4*pf^2 + 2*cos(betaf)*pf*qf - 2*qf^2))/(12*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)^(1/2)) - (2*cos(phif)*sin(psif)*(1 - (4*pf^2 + 2*cos(betaf)*pf*qf - 2*qf^2)^2/(64*(pf^2 - cos(betaf)*pf*qf + qf^2/4)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)))^(1/2)*(pf^2 - cos(betaf)*pf*qf + qf^2/4)^(1/2))/3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 (cos(phif)*sin(psif)*(8*pf + 2*qf*cos(betaf)))/(12*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)^(1/2)) + (cos(phif)*cos(psif)*(pf^2 - cos(betaf)*pf*qf + qf^2/4)^(1/2)*(((2*pf - qf*cos(betaf))*(4*pf^2 + 2*cos(betaf)*pf*qf - 2*qf^2)^2)/(64*(pf^2 - cos(betaf)*pf*qf + qf^2/4)^2*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)) + ((pf/2 + (qf*cos(betaf))/2)*(4*pf^2 + 2*cos(betaf)*pf*qf - 2*qf^2)^2)/(64*(pf^2 - cos(betaf)*pf*qf + qf^2/4)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)^2) - ((8*pf + 2*qf*cos(betaf))*(4*pf^2 + 2*cos(betaf)*pf*qf - 2*qf^2))/(32*(pf^2 - cos(betaf)*pf*qf + qf^2/4)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4))))/(3*(1 - (4*pf^2 + 2*cos(betaf)*pf*qf - 2*qf^2)^2/(64*(pf^2 - cos(betaf)*pf*qf + qf^2/4)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)))^(1/2)) + (cos(phif)*cos(psif)*(2*pf - qf*cos(betaf))*(1 - (4*pf^2 + 2*cos(betaf)*pf*qf - 2*qf^2)^2/(64*(pf^2 - cos(betaf)*pf*qf + qf^2/4)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)))^(1/2))/(3*(pf^2 - cos(betaf)*pf*qf + qf^2/4)^(1/2)) - (cos(phif)*sin(psif)*(pf/2 + (qf*cos(betaf))/2)*(4*pf^2 + 2*cos(betaf)*pf*qf - 2*qf^2))/(24*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)^(3/2)),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 (cos(phif)*cos(psif)*(pf^2 - cos(betaf)*pf*qf + qf^2/4)^(1/2)*(((qf/2 - pf*cos(betaf))*(4*pf^2 + 2*cos(betaf)*pf*qf - 2*qf^2)^2)/(64*(pf^2 - cos(betaf)*pf*qf + qf^2/4)^2*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)) + ((qf/2 + (pf*cos(betaf))/2)*(4*pf^2 + 2*cos(betaf)*pf*qf - 2*qf^2)^2)/(64*(pf^2 - cos(betaf)*pf*qf + qf^2/4)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)^2) + ((4*qf - 2*pf*cos(betaf))*(4*pf^2 + 2*cos(betaf)*pf*qf - 2*qf^2))/(32*(pf^2 - cos(betaf)*pf*qf + qf^2/4)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4))))/(3*(1 - (4*pf^2 + 2*cos(betaf)*pf*qf - 2*qf^2)^2/(64*(pf^2 - cos(betaf)*pf*qf + qf^2/4)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)))^(1/2)) - (cos(phif)*sin(psif)*(4*qf - 2*pf*cos(betaf)))/(12*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)^(1/2)) + (cos(phif)*cos(psif)*(qf/2 - pf*cos(betaf))*(1 - (4*pf^2 + 2*cos(betaf)*pf*qf - 2*qf^2)^2/(64*(pf^2 - cos(betaf)*pf*qf + qf^2/4)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)))^(1/2))/(3*(pf^2 - cos(betaf)*pf*qf + qf^2/4)^(1/2)) - (cos(phif)*sin(psif)*(qf/2 + (pf*cos(betaf))/2)*(4*pf^2 + 2*cos(betaf)*pf*qf - 2*qf^2))/(24*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)^(3/2)),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     (cos(phif)*cos(psif)*(pf^2 - cos(betaf)*pf*qf + qf^2/4)^(1/2)*((pf*qf*sin(betaf)*(4*pf^2 + 2*cos(betaf)*pf*qf - 2*qf^2)^2)/(64*(pf^2 - cos(betaf)*pf*qf + qf^2/4)^2*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)) - (pf*qf*sin(betaf)*(4*pf^2 + 2*cos(betaf)*pf*qf - 2*qf^2)^2)/(128*(pf^2 - cos(betaf)*pf*qf + qf^2/4)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)^2) + (pf*qf*sin(betaf)*(4*pf^2 + 2*cos(betaf)*pf*qf - 2*qf^2))/(16*(pf^2 - cos(betaf)*pf*qf + qf^2/4)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4))))/(3*(1 - (4*pf^2 + 2*cos(betaf)*pf*qf - 2*qf^2)^2/(64*(pf^2 - cos(betaf)*pf*qf + qf^2/4)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)))^(1/2)) - (pf*qf*cos(phif)*sin(betaf)*sin(psif))/(6*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)^(1/2)) + (pf*qf*cos(phif)*cos(psif)*sin(betaf)*(1 - (4*pf^2 + 2*cos(betaf)*pf*qf - 2*qf^2)^2/(64*(pf^2 - cos(betaf)*pf*qf + qf^2/4)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)))^(1/2))/(3*(pf^2 - cos(betaf)*pf*qf + qf^2/4)^(1/2)) + (pf*qf*cos(phif)*sin(betaf)*sin(psif)*(4*pf^2 + 2*cos(betaf)*pf*qf - 2*qf^2))/(48*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)^(3/2))
 0, 0, 1,                                                                                     - (2*cos(phif)*cos(psif)*cos(thetaf)*(1 - (4*pf^2 + 2*cos(betaf)*pf*qf - 2*qf^2)^2/(64*(pf^2 - cos(betaf)*pf*qf + qf^2/4)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)))^(1/2)*(pf^2 - cos(betaf)*pf*qf + qf^2/4)^(1/2))/3 - (cos(phif)*cos(thetaf)*sin(psif)*(4*pf^2 + 2*cos(betaf)*pf*qf - 2*qf^2))/(12*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)^(1/2)),                                                                                         (2*(cos(thetaf)*sin(psif) + cos(psif)*sin(phif)*sin(thetaf))*(1 - (4*pf^2 + 2*cos(betaf)*pf*qf - 2*qf^2)^2/(64*(pf^2 - cos(betaf)*pf*qf + qf^2/4)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)))^(1/2)*(pf^2 - cos(betaf)*pf*qf + qf^2/4)^(1/2))/3 - ((cos(psif)*cos(thetaf) - sin(phif)*sin(psif)*sin(thetaf))*(4*pf^2 + 2*cos(betaf)*pf*qf - 2*qf^2))/(12*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)^(1/2)),                                                                                       ((sin(psif)*sin(thetaf) - cos(psif)*cos(thetaf)*sin(phif))*(4*pf^2 + 2*cos(betaf)*pf*qf - 2*qf^2))/(12*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)^(1/2)) + (2*(cos(psif)*sin(thetaf) + cos(thetaf)*sin(phif)*sin(psif))*(1 - (4*pf^2 + 2*cos(betaf)*pf*qf - 2*qf^2)^2/(64*(pf^2 - cos(betaf)*pf*qf + qf^2/4)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)))^(1/2)*(pf^2 - cos(betaf)*pf*qf + qf^2/4)^(1/2))/3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         ((sin(psif)*sin(thetaf) - cos(psif)*cos(thetaf)*sin(phif))*(pf^2 - cos(betaf)*pf*qf + qf^2/4)^(1/2)*(((2*pf - qf*cos(betaf))*(4*pf^2 + 2*cos(betaf)*pf*qf - 2*qf^2)^2)/(64*(pf^2 - cos(betaf)*pf*qf + qf^2/4)^2*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)) + ((pf/2 + (qf*cos(betaf))/2)*(4*pf^2 + 2*cos(betaf)*pf*qf - 2*qf^2)^2)/(64*(pf^2 - cos(betaf)*pf*qf + qf^2/4)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)^2) - ((8*pf + 2*qf*cos(betaf))*(4*pf^2 + 2*cos(betaf)*pf*qf - 2*qf^2))/(32*(pf^2 - cos(betaf)*pf*qf + qf^2/4)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4))))/(3*(1 - (4*pf^2 + 2*cos(betaf)*pf*qf - 2*qf^2)^2/(64*(pf^2 - cos(betaf)*pf*qf + qf^2/4)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)))^(1/2)) - ((cos(psif)*sin(thetaf) + cos(thetaf)*sin(phif)*sin(psif))*(8*pf + 2*qf*cos(betaf)))/(12*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)^(1/2)) + ((cos(psif)*sin(thetaf) + cos(thetaf)*sin(phif)*sin(psif))*(pf/2 + (qf*cos(betaf))/2)*(4*pf^2 + 2*cos(betaf)*pf*qf - 2*qf^2))/(24*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)^(3/2)) + ((sin(psif)*sin(thetaf) - cos(psif)*cos(thetaf)*sin(phif))*(2*pf - qf*cos(betaf))*(1 - (4*pf^2 + 2*cos(betaf)*pf*qf - 2*qf^2)^2/(64*(pf^2 - cos(betaf)*pf*qf + qf^2/4)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)))^(1/2))/(3*(pf^2 - cos(betaf)*pf*qf + qf^2/4)^(1/2)),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         ((cos(psif)*sin(thetaf) + cos(thetaf)*sin(phif)*sin(psif))*(4*qf - 2*pf*cos(betaf)))/(12*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)^(1/2)) + ((sin(psif)*sin(thetaf) - cos(psif)*cos(thetaf)*sin(phif))*(pf^2 - cos(betaf)*pf*qf + qf^2/4)^(1/2)*(((qf/2 - pf*cos(betaf))*(4*pf^2 + 2*cos(betaf)*pf*qf - 2*qf^2)^2)/(64*(pf^2 - cos(betaf)*pf*qf + qf^2/4)^2*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)) + ((qf/2 + (pf*cos(betaf))/2)*(4*pf^2 + 2*cos(betaf)*pf*qf - 2*qf^2)^2)/(64*(pf^2 - cos(betaf)*pf*qf + qf^2/4)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)^2) + ((4*qf - 2*pf*cos(betaf))*(4*pf^2 + 2*cos(betaf)*pf*qf - 2*qf^2))/(32*(pf^2 - cos(betaf)*pf*qf + qf^2/4)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4))))/(3*(1 - (4*pf^2 + 2*cos(betaf)*pf*qf - 2*qf^2)^2/(64*(pf^2 - cos(betaf)*pf*qf + qf^2/4)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)))^(1/2)) + ((cos(psif)*sin(thetaf) + cos(thetaf)*sin(phif)*sin(psif))*(qf/2 + (pf*cos(betaf))/2)*(4*pf^2 + 2*cos(betaf)*pf*qf - 2*qf^2))/(24*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)^(3/2)) + ((sin(psif)*sin(thetaf) - cos(psif)*cos(thetaf)*sin(phif))*(qf/2 - pf*cos(betaf))*(1 - (4*pf^2 + 2*cos(betaf)*pf*qf - 2*qf^2)^2/(64*(pf^2 - cos(betaf)*pf*qf + qf^2/4)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)))^(1/2))/(3*(pf^2 - cos(betaf)*pf*qf + qf^2/4)^(1/2)),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             ((sin(psif)*sin(thetaf) - cos(psif)*cos(thetaf)*sin(phif))*(pf^2 - cos(betaf)*pf*qf + qf^2/4)^(1/2)*((pf*qf*sin(betaf)*(4*pf^2 + 2*cos(betaf)*pf*qf - 2*qf^2)^2)/(64*(pf^2 - cos(betaf)*pf*qf + qf^2/4)^2*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)) - (pf*qf*sin(betaf)*(4*pf^2 + 2*cos(betaf)*pf*qf - 2*qf^2)^2)/(128*(pf^2 - cos(betaf)*pf*qf + qf^2/4)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)^2) + (pf*qf*sin(betaf)*(4*pf^2 + 2*cos(betaf)*pf*qf - 2*qf^2))/(16*(pf^2 - cos(betaf)*pf*qf + qf^2/4)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4))))/(3*(1 - (4*pf^2 + 2*cos(betaf)*pf*qf - 2*qf^2)^2/(64*(pf^2 - cos(betaf)*pf*qf + qf^2/4)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)))^(1/2)) + (pf*qf*sin(betaf)*(cos(psif)*sin(thetaf) + cos(thetaf)*sin(phif)*sin(psif)))/(6*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)^(1/2)) - (pf*qf*sin(betaf)*(cos(psif)*sin(thetaf) + cos(thetaf)*sin(phif)*sin(psif))*(4*pf^2 + 2*cos(betaf)*pf*qf - 2*qf^2))/(48*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)^(3/2)) + (pf*qf*sin(betaf)*(sin(psif)*sin(thetaf) - cos(psif)*cos(thetaf)*sin(phif))*(1 - (4*pf^2 + 2*cos(betaf)*pf*qf - 2*qf^2)^2/(64*(pf^2 - cos(betaf)*pf*qf + qf^2/4)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)))^(1/2))/(3*(pf^2 - cos(betaf)*pf*qf + qf^2/4)^(1/2))
 1, 0, 0, (cos(phif)*sin(psif)*sin(thetaf)*(pf^2 - cos(betaf)*pf*qf + qf^2/4)^(1/2)*(- 2*pf^2 + 2*cos(betaf)*pf*qf + 4*qf^2))/(12*(pf^2/4 - cos(betaf)*pf*qf + qf^2)^(1/2)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)^(1/2)) - (2*cos(phif)*cos(psif)*sin(thetaf)*(1 - (- 2*pf^2 + 2*cos(betaf)*pf*qf + 4*qf^2)^2/(64*(pf^2/4 - cos(betaf)*pf*qf + qf^2)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)))^(1/2)*(pf^2/4 - cos(betaf)*pf*qf + qf^2)^(1/2))/3,   (2*(sin(psif)*sin(thetaf) - cos(psif)*cos(thetaf)*sin(phif))*(1 - (- 2*pf^2 + 2*cos(betaf)*pf*qf + 4*qf^2)^2/(64*(pf^2/4 - cos(betaf)*pf*qf + qf^2)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)))^(1/2)*(pf^2/4 - cos(betaf)*pf*qf + qf^2)^(1/2))/3 + ((cos(psif)*sin(thetaf) + cos(thetaf)*sin(phif)*sin(psif))*(pf^2 - cos(betaf)*pf*qf + qf^2/4)^(1/2)*(- 2*pf^2 + 2*cos(betaf)*pf*qf + 4*qf^2))/(12*(pf^2/4 - cos(betaf)*pf*qf + qf^2)^(1/2)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)^(1/2)), ((cos(thetaf)*sin(psif) + cos(psif)*sin(phif)*sin(thetaf))*(pf^2 - cos(betaf)*pf*qf + qf^2/4)^(1/2)*(- 2*pf^2 + 2*cos(betaf)*pf*qf + 4*qf^2))/(12*(pf^2/4 - cos(betaf)*pf*qf + qf^2)^(1/2)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)^(1/2)) - (2*(cos(psif)*cos(thetaf) - sin(phif)*sin(psif)*sin(thetaf))*(1 - (- 2*pf^2 + 2*cos(betaf)*pf*qf + 4*qf^2)^2/(64*(pf^2/4 - cos(betaf)*pf*qf + qf^2)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)))^(1/2)*(pf^2/4 - cos(betaf)*pf*qf + qf^2)^(1/2))/3, ((cos(psif)*cos(thetaf) - sin(phif)*sin(psif)*sin(thetaf))*(4*pf - 2*qf*cos(betaf))*(pf^2 - cos(betaf)*pf*qf + qf^2/4)^(1/2))/(12*(pf^2/4 - cos(betaf)*pf*qf + qf^2)^(1/2)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)^(1/2)) - ((cos(thetaf)*sin(psif) + cos(psif)*sin(phif)*sin(thetaf))*(pf/2 - qf*cos(betaf))*(1 - (- 2*pf^2 + 2*cos(betaf)*pf*qf + 4*qf^2)^2/(64*(pf^2/4 - cos(betaf)*pf*qf + qf^2)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)))^(1/2))/(3*(pf^2/4 - cos(betaf)*pf*qf + qf^2)^(1/2)) - ((cos(thetaf)*sin(psif) + cos(psif)*sin(phif)*sin(thetaf))*(pf^2/4 - cos(betaf)*pf*qf + qf^2)^(1/2)*(((pf/2 - qf*cos(betaf))*(- 2*pf^2 + 2*cos(betaf)*pf*qf + 4*qf^2)^2)/(64*(pf^2/4 - cos(betaf)*pf*qf + qf^2)^2*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)) + ((pf/2 + (qf*cos(betaf))/2)*(- 2*pf^2 + 2*cos(betaf)*pf*qf + 4*qf^2)^2)/(64*(pf^2/4 - cos(betaf)*pf*qf + qf^2)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)^2) + ((4*pf - 2*qf*cos(betaf))*(- 2*pf^2 + 2*cos(betaf)*pf*qf + 4*qf^2))/(32*(pf^2/4 - cos(betaf)*pf*qf + qf^2)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4))))/(3*(1 - (- 2*pf^2 + 2*cos(betaf)*pf*qf + 4*qf^2)^2/(64*(pf^2/4 - cos(betaf)*pf*qf + qf^2)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)))^(1/2)) - ((cos(psif)*cos(thetaf) - sin(phif)*sin(psif)*sin(thetaf))*(2*pf - qf*cos(betaf))*(- 2*pf^2 + 2*cos(betaf)*pf*qf + 4*qf^2))/(24*(pf^2/4 - cos(betaf)*pf*qf + qf^2)^(1/2)*(pf^2 - cos(betaf)*pf*qf + qf^2/4)^(1/2)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)^(1/2)) + ((cos(psif)*cos(thetaf) - sin(phif)*sin(psif)*sin(thetaf))*(pf/2 - qf*cos(betaf))*(pf^2 - cos(betaf)*pf*qf + qf^2/4)^(1/2)*(- 2*pf^2 + 2*cos(betaf)*pf*qf + 4*qf^2))/(24*(pf^2/4 - cos(betaf)*pf*qf + qf^2)^(3/2)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)^(1/2)) + ((cos(psif)*cos(thetaf) - sin(phif)*sin(psif)*sin(thetaf))*(pf/2 + (qf*cos(betaf))/2)*(pf^2 - cos(betaf)*pf*qf + qf^2/4)^(1/2)*(- 2*pf^2 + 2*cos(betaf)*pf*qf + 4*qf^2))/(24*(pf^2/4 - cos(betaf)*pf*qf + qf^2)^(1/2)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)^(3/2)), ((cos(psif)*cos(thetaf) - sin(phif)*sin(psif)*sin(thetaf))*(2*qf - pf*cos(betaf))*(pf^2 - cos(betaf)*pf*qf + qf^2/4)^(1/2)*(- 2*pf^2 + 2*cos(betaf)*pf*qf + 4*qf^2))/(24*(pf^2/4 - cos(betaf)*pf*qf + qf^2)^(3/2)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)^(1/2)) - ((cos(thetaf)*sin(psif) + cos(psif)*sin(phif)*sin(thetaf))*(2*qf - pf*cos(betaf))*(1 - (- 2*pf^2 + 2*cos(betaf)*pf*qf + 4*qf^2)^2/(64*(pf^2/4 - cos(betaf)*pf*qf + qf^2)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)))^(1/2))/(3*(pf^2/4 - cos(betaf)*pf*qf + qf^2)^(1/2)) - ((cos(psif)*cos(thetaf) - sin(phif)*sin(psif)*sin(thetaf))*(8*qf + 2*pf*cos(betaf))*(pf^2 - cos(betaf)*pf*qf + qf^2/4)^(1/2))/(12*(pf^2/4 - cos(betaf)*pf*qf + qf^2)^(1/2)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)^(1/2)) - ((cos(psif)*cos(thetaf) - sin(phif)*sin(psif)*sin(thetaf))*(qf/2 - pf*cos(betaf))*(- 2*pf^2 + 2*cos(betaf)*pf*qf + 4*qf^2))/(24*(pf^2/4 - cos(betaf)*pf*qf + qf^2)^(1/2)*(pf^2 - cos(betaf)*pf*qf + qf^2/4)^(1/2)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)^(1/2)) - ((cos(thetaf)*sin(psif) + cos(psif)*sin(phif)*sin(thetaf))*(pf^2/4 - cos(betaf)*pf*qf + qf^2)^(1/2)*(((2*qf - pf*cos(betaf))*(- 2*pf^2 + 2*cos(betaf)*pf*qf + 4*qf^2)^2)/(64*(pf^2/4 - cos(betaf)*pf*qf + qf^2)^2*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)) + ((qf/2 + (pf*cos(betaf))/2)*(- 2*pf^2 + 2*cos(betaf)*pf*qf + 4*qf^2)^2)/(64*(pf^2/4 - cos(betaf)*pf*qf + qf^2)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)^2) - ((8*qf + 2*pf*cos(betaf))*(- 2*pf^2 + 2*cos(betaf)*pf*qf + 4*qf^2))/(32*(pf^2/4 - cos(betaf)*pf*qf + qf^2)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4))))/(3*(1 - (- 2*pf^2 + 2*cos(betaf)*pf*qf + 4*qf^2)^2/(64*(pf^2/4 - cos(betaf)*pf*qf + qf^2)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)))^(1/2)) + ((cos(psif)*cos(thetaf) - sin(phif)*sin(psif)*sin(thetaf))*(qf/2 + (pf*cos(betaf))/2)*(pf^2 - cos(betaf)*pf*qf + qf^2/4)^(1/2)*(- 2*pf^2 + 2*cos(betaf)*pf*qf + 4*qf^2))/(24*(pf^2/4 - cos(betaf)*pf*qf + qf^2)^(1/2)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)^(3/2)), (pf*qf*sin(betaf)*(cos(psif)*cos(thetaf) - sin(phif)*sin(psif)*sin(thetaf))*(pf^2 - cos(betaf)*pf*qf + qf^2/4)^(1/2))/(6*(pf^2/4 - cos(betaf)*pf*qf + qf^2)^(1/2)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)^(1/2)) - (pf*qf*sin(betaf)*(cos(thetaf)*sin(psif) + cos(psif)*sin(phif)*sin(thetaf))*(1 - (- 2*pf^2 + 2*cos(betaf)*pf*qf + 4*qf^2)^2/(64*(pf^2/4 - cos(betaf)*pf*qf + qf^2)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)))^(1/2))/(3*(pf^2/4 - cos(betaf)*pf*qf + qf^2)^(1/2)) - ((cos(thetaf)*sin(psif) + cos(psif)*sin(phif)*sin(thetaf))*(pf^2/4 - cos(betaf)*pf*qf + qf^2)^(1/2)*((pf*qf*sin(betaf)*(- 2*pf^2 + 2*cos(betaf)*pf*qf + 4*qf^2)^2)/(64*(pf^2/4 - cos(betaf)*pf*qf + qf^2)^2*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)) - (pf*qf*sin(betaf)*(- 2*pf^2 + 2*cos(betaf)*pf*qf + 4*qf^2)^2)/(128*(pf^2/4 - cos(betaf)*pf*qf + qf^2)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)^2) + (pf*qf*sin(betaf)*(- 2*pf^2 + 2*cos(betaf)*pf*qf + 4*qf^2))/(16*(pf^2/4 - cos(betaf)*pf*qf + qf^2)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4))))/(3*(1 - (- 2*pf^2 + 2*cos(betaf)*pf*qf + 4*qf^2)^2/(64*(pf^2/4 - cos(betaf)*pf*qf + qf^2)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)))^(1/2)) - (pf*qf*sin(betaf)*(cos(psif)*cos(thetaf) - sin(phif)*sin(psif)*sin(thetaf))*(- 2*pf^2 + 2*cos(betaf)*pf*qf + 4*qf^2))/(24*(pf^2/4 - cos(betaf)*pf*qf + qf^2)^(1/2)*(pf^2 - cos(betaf)*pf*qf + qf^2/4)^(1/2)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)^(1/2)) - (pf*qf*sin(betaf)*(cos(psif)*cos(thetaf) - sin(phif)*sin(psif)*sin(thetaf))*(pf^2 - cos(betaf)*pf*qf + qf^2/4)^(1/2)*(- 2*pf^2 + 2*cos(betaf)*pf*qf + 4*qf^2))/(48*(pf^2/4 - cos(betaf)*pf*qf + qf^2)^(1/2)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)^(3/2)) + (pf*qf*sin(betaf)*(cos(psif)*cos(thetaf) - sin(phif)*sin(psif)*sin(thetaf))*(pf^2 - cos(betaf)*pf*qf + qf^2/4)^(1/2)*(- 2*pf^2 + 2*cos(betaf)*pf*qf + 4*qf^2))/(24*(pf^2/4 - cos(betaf)*pf*qf + qf^2)^(3/2)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)^(1/2))
 0, 1, 0,                         (2*cos(psif)*sin(phif)*(1 - (- 2*pf^2 + 2*cos(betaf)*pf*qf + 4*qf^2)^2/(64*(pf^2/4 - cos(betaf)*pf*qf + qf^2)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)))^(1/2)*(pf^2/4 - cos(betaf)*pf*qf + qf^2)^(1/2))/3 - (sin(phif)*sin(psif)*(pf^2 - cos(betaf)*pf*qf + qf^2/4)^(1/2)*(- 2*pf^2 + 2*cos(betaf)*pf*qf + 4*qf^2))/(12*(pf^2/4 - cos(betaf)*pf*qf + qf^2)^(1/2)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)^(1/2)),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               0,                                                                             (2*cos(phif)*sin(psif)*(1 - (- 2*pf^2 + 2*cos(betaf)*pf*qf + 4*qf^2)^2/(64*(pf^2/4 - cos(betaf)*pf*qf + qf^2)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)))^(1/2)*(pf^2/4 - cos(betaf)*pf*qf + qf^2)^(1/2))/3 + (cos(phif)*cos(psif)*(pf^2 - cos(betaf)*pf*qf + qf^2/4)^(1/2)*(- 2*pf^2 + 2*cos(betaf)*pf*qf + 4*qf^2))/(12*(pf^2/4 - cos(betaf)*pf*qf + qf^2)^(1/2)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)^(1/2)),                                                                                                                                                                                                                                     (cos(phif)*sin(psif)*(2*pf - qf*cos(betaf))*(- 2*pf^2 + 2*cos(betaf)*pf*qf + 4*qf^2))/(24*(pf^2/4 - cos(betaf)*pf*qf + qf^2)^(1/2)*(pf^2 - cos(betaf)*pf*qf + qf^2/4)^(1/2)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)^(1/2)) - (cos(phif)*cos(psif)*(pf/2 - qf*cos(betaf))*(1 - (- 2*pf^2 + 2*cos(betaf)*pf*qf + 4*qf^2)^2/(64*(pf^2/4 - cos(betaf)*pf*qf + qf^2)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)))^(1/2))/(3*(pf^2/4 - cos(betaf)*pf*qf + qf^2)^(1/2)) - (cos(phif)*sin(psif)*(4*pf - 2*qf*cos(betaf))*(pf^2 - cos(betaf)*pf*qf + qf^2/4)^(1/2))/(12*(pf^2/4 - cos(betaf)*pf*qf + qf^2)^(1/2)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)^(1/2)) - (cos(phif)*cos(psif)*(pf^2/4 - cos(betaf)*pf*qf + qf^2)^(1/2)*(((pf/2 - qf*cos(betaf))*(- 2*pf^2 + 2*cos(betaf)*pf*qf + 4*qf^2)^2)/(64*(pf^2/4 - cos(betaf)*pf*qf + qf^2)^2*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)) + ((pf/2 + (qf*cos(betaf))/2)*(- 2*pf^2 + 2*cos(betaf)*pf*qf + 4*qf^2)^2)/(64*(pf^2/4 - cos(betaf)*pf*qf + qf^2)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)^2) + ((4*pf - 2*qf*cos(betaf))*(- 2*pf^2 + 2*cos(betaf)*pf*qf + 4*qf^2))/(32*(pf^2/4 - cos(betaf)*pf*qf + qf^2)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4))))/(3*(1 - (- 2*pf^2 + 2*cos(betaf)*pf*qf + 4*qf^2)^2/(64*(pf^2/4 - cos(betaf)*pf*qf + qf^2)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)))^(1/2)) - (cos(phif)*sin(psif)*(pf/2 - qf*cos(betaf))*(pf^2 - cos(betaf)*pf*qf + qf^2/4)^(1/2)*(- 2*pf^2 + 2*cos(betaf)*pf*qf + 4*qf^2))/(24*(pf^2/4 - cos(betaf)*pf*qf + qf^2)^(3/2)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)^(1/2)) - (cos(phif)*sin(psif)*(pf/2 + (qf*cos(betaf))/2)*(pf^2 - cos(betaf)*pf*qf + qf^2/4)^(1/2)*(- 2*pf^2 + 2*cos(betaf)*pf*qf + 4*qf^2))/(24*(pf^2/4 - cos(betaf)*pf*qf + qf^2)^(1/2)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)^(3/2)),                                                                                                                                                                                                                                     (cos(phif)*sin(psif)*(8*qf + 2*pf*cos(betaf))*(pf^2 - cos(betaf)*pf*qf + qf^2/4)^(1/2))/(12*(pf^2/4 - cos(betaf)*pf*qf + qf^2)^(1/2)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)^(1/2)) - (cos(phif)*cos(psif)*(2*qf - pf*cos(betaf))*(1 - (- 2*pf^2 + 2*cos(betaf)*pf*qf + 4*qf^2)^2/(64*(pf^2/4 - cos(betaf)*pf*qf + qf^2)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)))^(1/2))/(3*(pf^2/4 - cos(betaf)*pf*qf + qf^2)^(1/2)) - (cos(phif)*cos(psif)*(pf^2/4 - cos(betaf)*pf*qf + qf^2)^(1/2)*(((2*qf - pf*cos(betaf))*(- 2*pf^2 + 2*cos(betaf)*pf*qf + 4*qf^2)^2)/(64*(pf^2/4 - cos(betaf)*pf*qf + qf^2)^2*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)) + ((qf/2 + (pf*cos(betaf))/2)*(- 2*pf^2 + 2*cos(betaf)*pf*qf + 4*qf^2)^2)/(64*(pf^2/4 - cos(betaf)*pf*qf + qf^2)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)^2) - ((8*qf + 2*pf*cos(betaf))*(- 2*pf^2 + 2*cos(betaf)*pf*qf + 4*qf^2))/(32*(pf^2/4 - cos(betaf)*pf*qf + qf^2)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4))))/(3*(1 - (- 2*pf^2 + 2*cos(betaf)*pf*qf + 4*qf^2)^2/(64*(pf^2/4 - cos(betaf)*pf*qf + qf^2)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)))^(1/2)) + (cos(phif)*sin(psif)*(qf/2 - pf*cos(betaf))*(- 2*pf^2 + 2*cos(betaf)*pf*qf + 4*qf^2))/(24*(pf^2/4 - cos(betaf)*pf*qf + qf^2)^(1/2)*(pf^2 - cos(betaf)*pf*qf + qf^2/4)^(1/2)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)^(1/2)) - (cos(phif)*sin(psif)*(2*qf - pf*cos(betaf))*(pf^2 - cos(betaf)*pf*qf + qf^2/4)^(1/2)*(- 2*pf^2 + 2*cos(betaf)*pf*qf + 4*qf^2))/(24*(pf^2/4 - cos(betaf)*pf*qf + qf^2)^(3/2)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)^(1/2)) - (cos(phif)*sin(psif)*(qf/2 + (pf*cos(betaf))/2)*(pf^2 - cos(betaf)*pf*qf + qf^2/4)^(1/2)*(- 2*pf^2 + 2*cos(betaf)*pf*qf + 4*qf^2))/(24*(pf^2/4 - cos(betaf)*pf*qf + qf^2)^(1/2)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)^(3/2)),                                                                                                                                                                                                                                     (pf*qf*cos(phif)*sin(betaf)*sin(psif)*(- 2*pf^2 + 2*cos(betaf)*pf*qf + 4*qf^2))/(24*(pf^2/4 - cos(betaf)*pf*qf + qf^2)^(1/2)*(pf^2 - cos(betaf)*pf*qf + qf^2/4)^(1/2)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)^(1/2)) - (pf*qf*cos(phif)*cos(psif)*sin(betaf)*(1 - (- 2*pf^2 + 2*cos(betaf)*pf*qf + 4*qf^2)^2/(64*(pf^2/4 - cos(betaf)*pf*qf + qf^2)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)))^(1/2))/(3*(pf^2/4 - cos(betaf)*pf*qf + qf^2)^(1/2)) - (pf*qf*cos(phif)*sin(betaf)*sin(psif)*(pf^2 - cos(betaf)*pf*qf + qf^2/4)^(1/2))/(6*(pf^2/4 - cos(betaf)*pf*qf + qf^2)^(1/2)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)^(1/2)) - (cos(phif)*cos(psif)*(pf^2/4 - cos(betaf)*pf*qf + qf^2)^(1/2)*((pf*qf*sin(betaf)*(- 2*pf^2 + 2*cos(betaf)*pf*qf + 4*qf^2)^2)/(64*(pf^2/4 - cos(betaf)*pf*qf + qf^2)^2*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)) - (pf*qf*sin(betaf)*(- 2*pf^2 + 2*cos(betaf)*pf*qf + 4*qf^2)^2)/(128*(pf^2/4 - cos(betaf)*pf*qf + qf^2)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)^2) + (pf*qf*sin(betaf)*(- 2*pf^2 + 2*cos(betaf)*pf*qf + 4*qf^2))/(16*(pf^2/4 - cos(betaf)*pf*qf + qf^2)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4))))/(3*(1 - (- 2*pf^2 + 2*cos(betaf)*pf*qf + 4*qf^2)^2/(64*(pf^2/4 - cos(betaf)*pf*qf + qf^2)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)))^(1/2)) + (pf*qf*cos(phif)*sin(betaf)*sin(psif)*(pf^2 - cos(betaf)*pf*qf + qf^2/4)^(1/2)*(- 2*pf^2 + 2*cos(betaf)*pf*qf + 4*qf^2))/(48*(pf^2/4 - cos(betaf)*pf*qf + qf^2)^(1/2)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)^(3/2)) - (pf*qf*cos(phif)*sin(betaf)*sin(psif)*(pf^2 - cos(betaf)*pf*qf + qf^2/4)^(1/2)*(- 2*pf^2 + 2*cos(betaf)*pf*qf + 4*qf^2))/(24*(pf^2/4 - cos(betaf)*pf*qf + qf^2)^(3/2)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)^(1/2))
 0, 0, 1, (2*cos(phif)*cos(psif)*cos(thetaf)*(1 - (- 2*pf^2 + 2*cos(betaf)*pf*qf + 4*qf^2)^2/(64*(pf^2/4 - cos(betaf)*pf*qf + qf^2)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)))^(1/2)*(pf^2/4 - cos(betaf)*pf*qf + qf^2)^(1/2))/3 - (cos(phif)*cos(thetaf)*sin(psif)*(pf^2 - cos(betaf)*pf*qf + qf^2/4)^(1/2)*(- 2*pf^2 + 2*cos(betaf)*pf*qf + 4*qf^2))/(12*(pf^2/4 - cos(betaf)*pf*qf + qf^2)^(1/2)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)^(1/2)), - (2*(cos(thetaf)*sin(psif) + cos(psif)*sin(phif)*sin(thetaf))*(1 - (- 2*pf^2 + 2*cos(betaf)*pf*qf + 4*qf^2)^2/(64*(pf^2/4 - cos(betaf)*pf*qf + qf^2)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)))^(1/2)*(pf^2/4 - cos(betaf)*pf*qf + qf^2)^(1/2))/3 - ((cos(psif)*cos(thetaf) - sin(phif)*sin(psif)*sin(thetaf))*(pf^2 - cos(betaf)*pf*qf + qf^2/4)^(1/2)*(- 2*pf^2 + 2*cos(betaf)*pf*qf + 4*qf^2))/(12*(pf^2/4 - cos(betaf)*pf*qf + qf^2)^(1/2)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)^(1/2)), ((sin(psif)*sin(thetaf) - cos(psif)*cos(thetaf)*sin(phif))*(pf^2 - cos(betaf)*pf*qf + qf^2/4)^(1/2)*(- 2*pf^2 + 2*cos(betaf)*pf*qf + 4*qf^2))/(12*(pf^2/4 - cos(betaf)*pf*qf + qf^2)^(1/2)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)^(1/2)) - (2*(cos(psif)*sin(thetaf) + cos(thetaf)*sin(phif)*sin(psif))*(1 - (- 2*pf^2 + 2*cos(betaf)*pf*qf + 4*qf^2)^2/(64*(pf^2/4 - cos(betaf)*pf*qf + qf^2)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)))^(1/2)*(pf^2/4 - cos(betaf)*pf*qf + qf^2)^(1/2))/3, ((cos(psif)*sin(thetaf) + cos(thetaf)*sin(phif)*sin(psif))*(4*pf - 2*qf*cos(betaf))*(pf^2 - cos(betaf)*pf*qf + qf^2/4)^(1/2))/(12*(pf^2/4 - cos(betaf)*pf*qf + qf^2)^(1/2)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)^(1/2)) - ((sin(psif)*sin(thetaf) - cos(psif)*cos(thetaf)*sin(phif))*(pf/2 - qf*cos(betaf))*(1 - (- 2*pf^2 + 2*cos(betaf)*pf*qf + 4*qf^2)^2/(64*(pf^2/4 - cos(betaf)*pf*qf + qf^2)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)))^(1/2))/(3*(pf^2/4 - cos(betaf)*pf*qf + qf^2)^(1/2)) - ((sin(psif)*sin(thetaf) - cos(psif)*cos(thetaf)*sin(phif))*(pf^2/4 - cos(betaf)*pf*qf + qf^2)^(1/2)*(((pf/2 - qf*cos(betaf))*(- 2*pf^2 + 2*cos(betaf)*pf*qf + 4*qf^2)^2)/(64*(pf^2/4 - cos(betaf)*pf*qf + qf^2)^2*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)) + ((pf/2 + (qf*cos(betaf))/2)*(- 2*pf^2 + 2*cos(betaf)*pf*qf + 4*qf^2)^2)/(64*(pf^2/4 - cos(betaf)*pf*qf + qf^2)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)^2) + ((4*pf - 2*qf*cos(betaf))*(- 2*pf^2 + 2*cos(betaf)*pf*qf + 4*qf^2))/(32*(pf^2/4 - cos(betaf)*pf*qf + qf^2)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4))))/(3*(1 - (- 2*pf^2 + 2*cos(betaf)*pf*qf + 4*qf^2)^2/(64*(pf^2/4 - cos(betaf)*pf*qf + qf^2)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)))^(1/2)) - ((cos(psif)*sin(thetaf) + cos(thetaf)*sin(phif)*sin(psif))*(2*pf - qf*cos(betaf))*(- 2*pf^2 + 2*cos(betaf)*pf*qf + 4*qf^2))/(24*(pf^2/4 - cos(betaf)*pf*qf + qf^2)^(1/2)*(pf^2 - cos(betaf)*pf*qf + qf^2/4)^(1/2)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)^(1/2)) + ((cos(psif)*sin(thetaf) + cos(thetaf)*sin(phif)*sin(psif))*(pf/2 - qf*cos(betaf))*(pf^2 - cos(betaf)*pf*qf + qf^2/4)^(1/2)*(- 2*pf^2 + 2*cos(betaf)*pf*qf + 4*qf^2))/(24*(pf^2/4 - cos(betaf)*pf*qf + qf^2)^(3/2)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)^(1/2)) + ((cos(psif)*sin(thetaf) + cos(thetaf)*sin(phif)*sin(psif))*(pf/2 + (qf*cos(betaf))/2)*(pf^2 - cos(betaf)*pf*qf + qf^2/4)^(1/2)*(- 2*pf^2 + 2*cos(betaf)*pf*qf + 4*qf^2))/(24*(pf^2/4 - cos(betaf)*pf*qf + qf^2)^(1/2)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)^(3/2)), ((cos(psif)*sin(thetaf) + cos(thetaf)*sin(phif)*sin(psif))*(2*qf - pf*cos(betaf))*(pf^2 - cos(betaf)*pf*qf + qf^2/4)^(1/2)*(- 2*pf^2 + 2*cos(betaf)*pf*qf + 4*qf^2))/(24*(pf^2/4 - cos(betaf)*pf*qf + qf^2)^(3/2)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)^(1/2)) - ((sin(psif)*sin(thetaf) - cos(psif)*cos(thetaf)*sin(phif))*(2*qf - pf*cos(betaf))*(1 - (- 2*pf^2 + 2*cos(betaf)*pf*qf + 4*qf^2)^2/(64*(pf^2/4 - cos(betaf)*pf*qf + qf^2)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)))^(1/2))/(3*(pf^2/4 - cos(betaf)*pf*qf + qf^2)^(1/2)) - ((cos(psif)*sin(thetaf) + cos(thetaf)*sin(phif)*sin(psif))*(8*qf + 2*pf*cos(betaf))*(pf^2 - cos(betaf)*pf*qf + qf^2/4)^(1/2))/(12*(pf^2/4 - cos(betaf)*pf*qf + qf^2)^(1/2)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)^(1/2)) - ((cos(psif)*sin(thetaf) + cos(thetaf)*sin(phif)*sin(psif))*(qf/2 - pf*cos(betaf))*(- 2*pf^2 + 2*cos(betaf)*pf*qf + 4*qf^2))/(24*(pf^2/4 - cos(betaf)*pf*qf + qf^2)^(1/2)*(pf^2 - cos(betaf)*pf*qf + qf^2/4)^(1/2)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)^(1/2)) - ((sin(psif)*sin(thetaf) - cos(psif)*cos(thetaf)*sin(phif))*(pf^2/4 - cos(betaf)*pf*qf + qf^2)^(1/2)*(((2*qf - pf*cos(betaf))*(- 2*pf^2 + 2*cos(betaf)*pf*qf + 4*qf^2)^2)/(64*(pf^2/4 - cos(betaf)*pf*qf + qf^2)^2*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)) + ((qf/2 + (pf*cos(betaf))/2)*(- 2*pf^2 + 2*cos(betaf)*pf*qf + 4*qf^2)^2)/(64*(pf^2/4 - cos(betaf)*pf*qf + qf^2)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)^2) - ((8*qf + 2*pf*cos(betaf))*(- 2*pf^2 + 2*cos(betaf)*pf*qf + 4*qf^2))/(32*(pf^2/4 - cos(betaf)*pf*qf + qf^2)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4))))/(3*(1 - (- 2*pf^2 + 2*cos(betaf)*pf*qf + 4*qf^2)^2/(64*(pf^2/4 - cos(betaf)*pf*qf + qf^2)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)))^(1/2)) + ((cos(psif)*sin(thetaf) + cos(thetaf)*sin(phif)*sin(psif))*(qf/2 + (pf*cos(betaf))/2)*(pf^2 - cos(betaf)*pf*qf + qf^2/4)^(1/2)*(- 2*pf^2 + 2*cos(betaf)*pf*qf + 4*qf^2))/(24*(pf^2/4 - cos(betaf)*pf*qf + qf^2)^(1/2)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)^(3/2)), (pf*qf*sin(betaf)*(cos(psif)*sin(thetaf) + cos(thetaf)*sin(phif)*sin(psif))*(pf^2 - cos(betaf)*pf*qf + qf^2/4)^(1/2))/(6*(pf^2/4 - cos(betaf)*pf*qf + qf^2)^(1/2)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)^(1/2)) - (pf*qf*sin(betaf)*(sin(psif)*sin(thetaf) - cos(psif)*cos(thetaf)*sin(phif))*(1 - (- 2*pf^2 + 2*cos(betaf)*pf*qf + 4*qf^2)^2/(64*(pf^2/4 - cos(betaf)*pf*qf + qf^2)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)))^(1/2))/(3*(pf^2/4 - cos(betaf)*pf*qf + qf^2)^(1/2)) - ((sin(psif)*sin(thetaf) - cos(psif)*cos(thetaf)*sin(phif))*(pf^2/4 - cos(betaf)*pf*qf + qf^2)^(1/2)*((pf*qf*sin(betaf)*(- 2*pf^2 + 2*cos(betaf)*pf*qf + 4*qf^2)^2)/(64*(pf^2/4 - cos(betaf)*pf*qf + qf^2)^2*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)) - (pf*qf*sin(betaf)*(- 2*pf^2 + 2*cos(betaf)*pf*qf + 4*qf^2)^2)/(128*(pf^2/4 - cos(betaf)*pf*qf + qf^2)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)^2) + (pf*qf*sin(betaf)*(- 2*pf^2 + 2*cos(betaf)*pf*qf + 4*qf^2))/(16*(pf^2/4 - cos(betaf)*pf*qf + qf^2)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4))))/(3*(1 - (- 2*pf^2 + 2*cos(betaf)*pf*qf + 4*qf^2)^2/(64*(pf^2/4 - cos(betaf)*pf*qf + qf^2)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)))^(1/2)) - (pf*qf*sin(betaf)*(cos(psif)*sin(thetaf) + cos(thetaf)*sin(phif)*sin(psif))*(- 2*pf^2 + 2*cos(betaf)*pf*qf + 4*qf^2))/(24*(pf^2/4 - cos(betaf)*pf*qf + qf^2)^(1/2)*(pf^2 - cos(betaf)*pf*qf + qf^2/4)^(1/2)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)^(1/2)) - (pf*qf*sin(betaf)*(cos(psif)*sin(thetaf) + cos(thetaf)*sin(phif)*sin(psif))*(pf^2 - cos(betaf)*pf*qf + qf^2/4)^(1/2)*(- 2*pf^2 + 2*cos(betaf)*pf*qf + 4*qf^2))/(48*(pf^2/4 - cos(betaf)*pf*qf + qf^2)^(1/2)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)^(3/2)) + (pf*qf*sin(betaf)*(cos(psif)*sin(thetaf) + cos(thetaf)*sin(phif)*sin(psif))*(pf^2 - cos(betaf)*pf*qf + qf^2/4)^(1/2)*(- 2*pf^2 + 2*cos(betaf)*pf*qf + 4*qf^2))/(24*(pf^2/4 - cos(betaf)*pf*qf + qf^2)^(3/2)*(pf^2/4 + (cos(betaf)*pf*qf)/2 + qf^2/4)^(1/2))]
 

%%%%%%%%%%%%%

 
x1=pos(1);
y1=pos(2);
z1=pos(3);
x2=pos(4);
y2=pos(5);
z2=pos(6);
x3=pos(7);
y3=pos(8);
z3=pos(9);

qpf=[(x1+x2+x3)/3;...
     (y1+y2+y3)/3;...
     (z1+z2+z3)/3;...
     atan2((2*z1/3-z2/3-z3/3),(2*y1/3-y2/3-y3/3)); ...
     -atan2((2*z1/3-z2/3-z3/3),(2*x1/3-x2/3-x3/3)); ...
     atan2((2*y1/3-y2/3-y3/3),(2*x1/3-x2/3-x3/3))];
 
qsf=[sqrt((x1-x2)^2+(y1-y2)^2+(z1-z2)^2); ...
     sqrt((x1-x3)^2+(y1-y3)^2+(z1-z3)^2); ...
     acos((pf^2+qf^2-rf^2)/(2*pf*qf))];
 
 q = [qpf;qsf];
%%%%%%%%%%%%%
%%%pos_desired%%%%%%%
%  pos_des =  eval(eps);

%  jacval  =  eval(jac);
% 
%  qd = eval(qd);%subs(qd,t,tm);
%  q  = eval(q);
 qe = qd - q;
%  qddot = eval(qddot);%subs(qddot,t,tm);
 kappa=0.2*eye(9);
 qrefdot = qddot + kappa*qe;

 vel_des = jac_val*qrefdot;
%  vel_des = subs(vel_des,t,tm);
 acc_des = zeros(3,1);
% 
yaw = 0;
yawdot = 0;
% =================== Your code ends here ===================

desired_state1 = [pos_des(1:3);vel_des(1:3);acc_des];
desired_state2 = [pos_des(4:6);vel_des(4:6);acc_des];
desired_state3 = [pos_des(7:9);vel_des(7:9);acc_des];
% Pf = subs(Pf,t,tm);
% Sf = subs(Sf,t,tm);
% format short
% digits(3);
desired_state = [desired_state1;desired_state2;desired_state3; psif; 0; Pf; Sf]
size(desired_state)
end
    